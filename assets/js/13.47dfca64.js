(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{285:function(s,a,t){s.exports=t.p+"assets/img/工作流模块结构图.30e6d393.png"},346:function(s,a,t){"use strict";t.r(a);var n=t(3),r=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"工作流作为独立模块部署支持"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作流作为独立模块部署支持"}},[s._v("#")]),s._v(" 工作流作为独立模块部署支持")]),s._v(" "),a("h2",{attrs:{id:"内网maven仓库地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#内网maven仓库地址"}},[s._v("#")]),s._v(" 内网Maven仓库地址")]),s._v(" "),a("p",[a("a",{attrs:{href:"http://192.168.176.10:8081/nexus/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Maven仓库(http://192.168.176.10:8081/nexus/)"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("注意下文中的Maven坐标均可通过该仓库获取")]),s._v(" "),a("h2",{attrs:{id:"工作流模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#工作流模块"}},[s._v("#")]),s._v(" 工作流模块")]),s._v(" "),a("p",[s._v("模块结构图")]),s._v(" "),a("img",{attrs:{src:t(285),title:"",alt:"工作流模块结构图","data-align":"center"}}),s._v(" "),a("h3",{attrs:{id:"workflow-webapp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#workflow-webapp"}},[s._v("#")]),s._v(" Workflow Webapp")]),s._v(" "),a("p",[s._v("工作流REST服务模块，提供工作流服务、工作流资源服务、工作流管理管理服务。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意工作流服务、工作流资源服务与IGServer接口标准基本相同，但缺少了一些带有IGServer业务的额外特性，比如服务目录。")])]),s._v(" "),a("p",[s._v("工作流管理服务提供简易版的管理服务，提供工作流的列表查询、导入、导出、删除接口，这些服务在IGServer并未公开，因此这些服务与IGServer的管理服务没有对应关系，这里只是在去除一些业务依赖后，提取了IGServer中最基本的工作流服务管理能力。")]),s._v(" "),a("p",[s._v("该进程只是IGServer对外提供Webapp的demo程序，本身不带任何业务，只有一些springboot的配置，用户可以构建自己的工作流Webapp")]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mapgis-igs-workflow-standalone-webapp"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.zondy.mapgis.igs"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("10.x.x.x"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("用户在构建自己的工作流Webapp时，如果需要开启内置的REST服务，请添加如下依赖，并开启配置"),a("code",[s._v("workflow.standalone.restEnabled=true")])]),s._v(" "),a("div",{staticClass:"language-xml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-xml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("mapgis-igs-workflow-service"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("artifactId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("com.zondy.mapgis.igs"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("groupId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("10.x.x.x"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("独立部署配置类详情，添加依赖后，IDEA中可自动提示")]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Getter")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@Setter")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[s._v("@ConfigurationProperties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"workflow.standalone"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WorkflowStandaloneConfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 是否启用rest服务\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("boolean")]),s._v(" restEnabled"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 工作流服务的基地址，默认为/igs/rest/services\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" restServicesBaseUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n     * 工作流服务的基地址，默认为/igs/rest/manager\n     */")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" restManagerBaseUrl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("在igserver_for_java安装包中已集成该进程的启动脚本，在bin目录下"),a("code",[s._v("start-workflow-standalone-webapp.bat")]),s._v(","),a("code",[s._v("start-workflow-standalone-webapp.sh")]),s._v(",该进程需要依赖zookeeper与WorkflowServerHost进行rpc通信，所以启动服务请使用startup-workflow-standalone.bat、startup-workflow-standalone.sh。")]),s._v(" "),a("p",[s._v("该进程默认端口为"),a("code",[s._v("8099")]),s._v("，如果需要查看工作流独立模块支持的rest服务接口，请参照http://localhost:8099/swagger-ui/index.html")]),s._v(" "),a("h3",{attrs:{id:"workflowserverhost"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#workflowserverhost"}},[s._v("#")]),s._v(" WorkflowServerHost")]),s._v(" "),a("p",[s._v("工作流执行进程，由于工作流任务执行在独立进程中执行，用户发送请求执行任务请求到Workflow Webapp后，该模块处理任务并将任务调度到指定的工作流执行进程上，这里进程之间通过dubbo rpc通信。")]),s._v(" "),a("h3",{attrs:{id:"functionlibraryserverhost"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#functionlibraryserverhost"}},[s._v("#")]),s._v(" FunctionLibraryServerHost")]),s._v(" "),a("p",[s._v("该模块提供用于通过桌面工具搭建工作流时（IGSWorkflow.exe），依赖的socket服务，提供功能库的解析和执行服务。")]),s._v(" "),a("p",[s._v("在igserver_for_java安装包中已集成该进程的启动脚本，在bin目录下"),a("code",[s._v("start-function-library-server-host.bat")])]),s._v(" "),a("h2",{attrs:{id:"开发包文件清单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开发包文件清单"}},[s._v("#")]),s._v(" 开发包文件清单")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("workflow-standalone-webapp\n  ├── workflow "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#工作流流程、功能仓库，下面的子文件、文件夹均需要")]),s._v("\n  ├── zookeeper "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#rpc通信需要")]),s._v("\n  ├── bin \n  │   ├── startup-workflow-standalone.bat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("startup-workflow-standalone.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#工作流webapp的总启动脚本,包括webapp、zookeeper")]),s._v("\n  │   ├── set-env.bat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("set-env.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置环境变量")]),s._v("\n  │   ├── shutdown.bat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shutdown.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#关闭进程")]),s._v("\n  │   ├── env.config "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开发者狗配置")]),s._v("\n  │   ├── start-function-library-server-host.bat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start-function-library-server-host.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#功能仓库服务启动脚本")]),s._v("\n  │   └── start-workflow-standalone-webapp.bat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("start-workflow-standalone-webapp.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#单独启动工作流webapp")]),s._v("\n  └── lib\n      ├──  workflow-host-*.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#工作流执行进程")]),s._v("\n      ├──  function-library-server-host-*.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#功能仓库服务进程")]),s._v("\n      └──  workflow-standalone-webapp-*.jar "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#demo webapp，从仓库中取，安装包中不包含")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("igserver工作流独立模块自带igserver的功能函数，数据库存在于workflow\\FunctionLibrary下，功能实现的jar包igserver-workflow-library.jar位于workflow\\FunctionLibrary\\GIS\\MapGIS\\jar文件夹中，当用户不需要使用igserver自带的功能函数时，可以将数据库清空并且删除igserver-workflow-library.jar，之后可以将自己开发的jar包放入对应的目录中，igserver工作流独立模块根据是否需要依赖内核接口来分别搭建工程")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("如果开发的jar包依赖了内核接口，工程目录workflow-standalone-webapp的存放位置必须和program在同一目录下，考虑到依赖内核产生的授权问题，服务器最好不要设置java的环境变量，工程启动默认使用program目录自带的java环境")])]),s._v(" "),a("li",[a("p",[s._v("如果开发的jar包不依赖内核接口，整个工程会非常轻量级，将不会有program目录，对应也不会有program目录自带的java环境，所以服务器需要提前搭建好java环境")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);